<extend name="Public/base" />

<block name="body">
<div class="row-fluid">
				<div class="box span12">
					<div class="navbar">
						<div class="navbar-inner">
							<div class="container">
								<div class="nav-collapse collapse navbar-responsive-collapse">
									<ul class="nav nav-pills" id="menutree">
									</ul>
									<form class="navbar-search pull-right" action="#">
									 	<input type="text" name="query" class="search-query" placeholder="Search">
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
</div>
<div class="row-fluid sortable">		
				<div class="box span12">
					<div class="box-header well" data-original-title>
						<h2><i class="icon-barcode"></i> 商品列表</h2>
						<div class="box-icon">
							<a href="#" class="btn btn-setting btn-round"><i class="icon-cog"></i></a>
							<a href="#" class="btn btn-minimize btn-round"><i class="icon-chevron-up"></i></a>
							<a href="#" class="btn btn-close btn-round"><i class="icon-remove"></i></a>
						</div>
					</div>
					<div class="box-content">
						<?php
						//dump($_list);
						$thead = array(
								'id'             => 'ID',
								'good_id'        => '货号',
								'barcode'        => '条码',
								'good_name'      => '商品名称',
								'good_spec'      => '规格',
								'good_price'     => '价格',
								'good_pur_price' => '进价',
								'good_belong'    => '供应商',
								'good_num'       => '库存',
								'操作'             =>array(),
							);
						echo $_talellist = $__controller__->tableList($_list,$thead);
						?> 
						<div class="pagination pagination-centered">  
					 		{$_page}
					 	</div>
					</div>
				</div><!--/span-->
			
			</div><!--/row-->
</block>
<block name="script">
<script src="__JS__/bootstrap-exdropdown.js"></script>
<script type="text/javascript">
$(function(){
	var targetUrl = '{:U('index','','')}';
	$.ajax({
		url:"http://www.test.com/index.php/Admin/Good/json",
		dataType:"json",
		type:"get",
		success:function(data,status,xhr) {
			var menu = $("#menutree");
			makemenu(data,menu);
		}
	});

	function makemenu(data,node){
		//var menu = $("#menutree");
			$.each(data.childs,function(index,item){
				var li = $("<li/>").appendTo(node);
				
				var a=$("<a />",{href:targetUrl+"/cate_id/"+item.categoryId,text:item.categoryName});
				if(item.hasChild){
					a.attr({
						'data-toggle': 'exdropdown',
					});
					a.addClass('dropdown-toggle');
					a.append('<b class="caret">');
				}
				li.append(a);
				if(item.hasChild)
				{
					li.addClass('dropdown');
					makesubmenu(item,li);
				}
				//menu.append(item.categoryName);
			});
	}

	function makesubmenu(data,node){
		var ul = $('<ul/>').appendTo(node);
		ul.addClass('dropdown-menu');
		$.each(data.childs,function(index,item){
			var li =$('<li/>');
			var a  =$('<a/>');
			a.attr('href',targetUrl+"/cate_id/"+item.categoryId);
			a.append(item.categoryName);
			if(item.hasChild){
				a.attr('tabindex', '-1');
				
				li.addClass('dropdown-submenu');
				makesubmenu(item,li);
			}
			li.append(a);
			ul.append(li);
		});
	}
} );
</script>
</block>